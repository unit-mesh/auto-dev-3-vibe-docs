# Temporal vs æˆ‘ä»¬çš„å®ç°æ–¹æ¡ˆ - æ·±åº¦å¯¹æ¯”åˆ†æ

> **ç›®æ ‡**: å¯¹æ¯” Temporal çš„æ ¸å¿ƒæœºåˆ¶ä¸æˆ‘ä»¬çš„å®ç°æ–¹æ¡ˆï¼Œæ˜ç¡®è®¾è®¡å†³ç­–çš„ç†ç”±

---

## ä¸€ã€æ ¸å¿ƒæ¶æ„å¯¹æ¯”

### 1.1 Temporal æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        Client Applications                      â”‚
â”‚                    (Temporal SDK - Java/Go/Python)              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚ gRPC
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Temporal Server (Go)                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Frontend  â”‚  â”‚  History   â”‚  â”‚  Matching  â”‚  â”‚ Worker   â”‚ â”‚
â”‚  â”‚  Service   â”‚  â”‚  Service   â”‚  â”‚  Service   â”‚  â”‚ Service  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚         â”‚                â”‚                â”‚                      â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚
â”‚                          â”‚                                       â”‚
â”‚                          â–¼                                       â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
â”‚         â”‚    Database (Cassandra/PostgreSQL)  â”‚                 â”‚
â”‚         â”‚    - Events                         â”‚                 â”‚
â”‚         â”‚    - Executions                     â”‚                 â”‚
â”‚         â”‚    - Tasks                          â”‚                 â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        Workers (å¤šè¯­è¨€)                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Workflow Workerâ”‚  â”‚ Activity Workerâ”‚  â”‚ Activity Workerâ”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Temporal çš„å…³é”®ç»„ä»¶**:
- **Frontend Service**: æ¥æ”¶å®¢æˆ·ç«¯è¯·æ±‚ï¼Œè·¯ç”±åˆ° History Service
- **History Service**: æ ¸å¿ƒï¼Œç®¡ç†å·¥ä½œæµçŠ¶æ€å’Œäº‹ä»¶å†å²ï¼ˆåˆ†ç‰‡è®¾è®¡ï¼‰
- **Matching Service**: ä»»åŠ¡é˜Ÿåˆ—ï¼Œå°†ä»»åŠ¡åˆ†é…ç»™ Worker
- **Worker**: æ‰§è¡Œ Workflow å’Œ Activity ä»£ç 

### 1.2 æˆ‘ä»¬çš„æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                Client (Android/Web/CLI)                         â”‚
â”‚                   (HTTP Client + SSE)                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚ HTTP/SSE
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      mpp-server (Ktor)                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   WorkflowController (REST API)                          â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                         â”‚                                        â”‚
â”‚                         â–¼                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   WorkflowEngine                                         â”‚  â”‚
â”‚  â”‚   - startWorkflow()                                      â”‚  â”‚
â”‚  â”‚   - resumeWorkflow()                                     â”‚  â”‚
â”‚  â”‚   - sendSignal()                                         â”‚  â”‚
â”‚  â”‚   - executeQuery()                                       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚            â”‚                    â”‚                    â”‚           â”‚
â”‚            â–¼                    â–¼                    â–¼           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚ EventStore   â”‚    â”‚ Checkpoint   â”‚    â”‚ SignalQueue  â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚            â”‚                    â”‚                    â”‚           â”‚
â”‚            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                                 â”‚                                â”‚
â”‚                                 â–¼                                â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚         â”‚  SQLite/PostgreSQL                      â”‚             â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    mpp-core (Agent Logic)                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   DurableAgentExecutor (å†…åµŒ Worker)                      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                         â”‚                                        â”‚
â”‚                         â–¼                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   CodingAgent + Tools                                    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æˆ‘ä»¬çš„å…³é”®ç»„ä»¶**:
- **WorkflowController**: å¯¹åº” Frontend Service
- **WorkflowEngine**: å¯¹åº” History Serviceï¼ˆç®€åŒ–ç‰ˆï¼‰
- **DurableAgentExecutor**: å¯¹åº” Workerï¼ˆå†…åµŒåœ¨åŒä¸€è¿›ç¨‹ï¼‰
- **EventStore/CheckpointManager**: å¯¹åº” Database å±‚

### 1.3 æ¶æ„å¯¹æ¯”

| ç»´åº¦ | Temporal | æˆ‘ä»¬çš„æ–¹æ¡ˆ | æƒè¡¡åˆ†æ |
|-----|---------|-----------|---------|
| **æœåŠ¡æ‹†åˆ†** | 4 ä¸ªç‹¬ç«‹æœåŠ¡ | å•ä½“ï¼ˆå•ä¸ª Ktor è¿›ç¨‹ï¼‰ | âŒ å¯æ‰©å±•æ€§ä½ï¼Œä½† âœ… ç®€åŒ–éƒ¨ç½² |
| **Worker æ¨¡å‹** | ç‹¬ç«‹è¿›ç¨‹ï¼Œå¤šè¯­è¨€ | å†…åµŒè¿›ç¨‹ï¼ŒKotlin only | âŒ çµæ´»æ€§ä½ï¼Œä½† âœ… ä½å»¶è¿Ÿ |
| **ä»»åŠ¡é˜Ÿåˆ—** | ä¸“é—¨çš„ Matching Service | åç¨‹ Channel | âŒ ååé‡æœ‰é™ï¼Œä½† âœ… å®ç°ç®€å• |
| **åˆ†ç‰‡** | History Service åˆ†ç‰‡ | æ— åˆ†ç‰‡ï¼ˆå•æ•°æ®åº“ï¼‰ | âŒ å•æœºç“¶é¢ˆï¼Œä½† âœ… å¼ºä¸€è‡´æ€§ |
| **åè®®** | gRPCï¼ˆäºŒè¿›åˆ¶ï¼‰ | HTTP/JSON + SSE | âŒ æ€§èƒ½ç¨ä½ï¼Œä½† âœ… æ˜“è°ƒè¯• |
| **æ•°æ®åº“** | Cassandra/PostgreSQL | SQLite/PostgreSQL | âœ… çµæ´»ï¼Œé€‚é…å¤šå¹³å° |

**æ€»ç»“**: æˆ‘ä»¬çš„æ–¹æ¡ˆæ˜¯ **"Temporal Lite"**ï¼Œç‰ºç‰²äº†æ°´å¹³æ‰©å±•èƒ½åŠ›ï¼Œæ¢å–äº†ç®€å•æ€§å’Œå¿«é€Ÿå®æ–½ã€‚

---

## äºŒã€æ ¸å¿ƒæœºåˆ¶å¯¹æ¯”

### 2.1 äº‹ä»¶æº¯æº (Event Sourcing)

#### Temporal çš„å®ç°
```
Workflow Execution:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Event ID | Event Type                | Event Data         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1        | WorkflowExecutionStarted  | {...}              â”‚
â”‚ 2        | WorkflowTaskScheduled     | {...}              â”‚
â”‚ 3        | WorkflowTaskStarted       | {...}              â”‚
â”‚ 4        | WorkflowTaskCompleted     | Decisions: [...]   â”‚
â”‚ 5        | ActivityTaskScheduled     | ActivityType: A    â”‚
â”‚ 6        | ActivityTaskStarted       | {...}              â”‚
â”‚ 7        | ActivityTaskCompleted     | Result: "X"        â”‚
â”‚ 8        | WorkflowTaskScheduled     | {...}              â”‚
â”‚ ...      | ...                       | ...                â”‚
â”‚ 99       | WorkflowExecutionCompleted| Result: "Success"  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ç‰¹ç‚¹**:
- âœ… éå¸¸ç»†ç²’åº¦ï¼ˆæ¯ä¸ªå†³ç­–ã€æ¯ä¸ªä»»åŠ¡è°ƒåº¦éƒ½æ˜¯ä¸€ä¸ªäº‹ä»¶ï¼‰
- âœ… å®Œæ•´çš„å®¡è®¡æ—¥å¿—
- âŒ äº‹ä»¶æ•°é‡å·¨å¤§ï¼ˆå¯èƒ½æ•°åƒä¸ªäº‹ä»¶/å·¥ä½œæµï¼‰

#### æˆ‘ä»¬çš„å®ç°
```
Workflow Execution:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Seq  | Event Type                | Event Data             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1    | WorkflowStarted           | Task: "..."            â”‚
â”‚ 2    | IterationStart            | Iteration: 1           â”‚
â”‚ 3    | LLMCall                   | Result: "..."          â”‚
â”‚ 4    | ToolCall:read_file        | Result: {...}          â”‚
â”‚ 5    | ToolCall:write_file       | Result: {...}          â”‚
â”‚ 6    | StepCompleted             | Step: {...}            â”‚
â”‚ 7    | IterationCompleted        | {...}                  â”‚
â”‚ 8    | WaitingForSignal          | SignalName: "approval" â”‚
â”‚ 9    | SignalReceived            | Data: {...}            â”‚
â”‚ 10   | WorkflowCompleted         | Success: true          â”‚
â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ç‰¹ç‚¹**:
- âœ… ç²—ç²’åº¦ï¼ˆåªè®°å½•ä¸šåŠ¡ç›¸å…³çš„äº‹ä»¶ï¼‰
- âœ… äº‹ä»¶æ•°é‡å°‘ï¼ˆæ•°åä¸ªäº‹ä»¶/å·¥ä½œæµï¼‰
- âŒ å®¡è®¡ç²’åº¦è¾ƒç²—

**æƒè¡¡**: æˆ‘ä»¬ç‰ºç‰²äº†å®¡è®¡çš„ç»†ç²’åº¦ï¼Œæ¢å–äº†å­˜å‚¨æ•ˆç‡å’ŒæŸ¥è¯¢æ€§èƒ½ã€‚

### 2.2 ç¡®å®šæ€§é‡æ”¾ (Deterministic Replay)

#### Temporal çš„å®ç°

**å·¥ä½œæµä»£ç è¦æ±‚**:
```java
// Temporal Workflow (Java)
@WorkflowInterface
public interface GreetingWorkflow {
    @WorkflowMethod
    String greet(String name);
}

public class GreetingWorkflowImpl implements GreetingWorkflow {
    @Override
    public String greet(String name) {
        // âŒ ç¦æ­¢ï¼šRandom.nextInt()
        // âŒ ç¦æ­¢ï¼šSystem.currentTimeMillis()
        // âŒ ç¦æ­¢ï¼šnew Thread()
        // âœ… å…è®¸ï¼šWorkflow.now()
        // âœ… å…è®¸ï¼šWorkflow.sleep()
        
        // Activity è°ƒç”¨ï¼ˆéç¡®å®šæ€§æ“ä½œéš”ç¦»ï¼‰
        GreetingActivities activities = Workflow.newActivityStub(...);
        String greeting = activities.composeGreeting(name);
        
        // âœ… å…è®¸ï¼šçº¯å‡½æ•°é€»è¾‘
        return greeting.toUpperCase();
    }
}
```

**é‡æ”¾æœºåˆ¶**:
1. Worker å´©æºƒåï¼Œä»»åŠ¡é‡æ–°è°ƒåº¦åˆ°å¦ä¸€ä¸ª Worker
2. æ–° Worker ä»å¤´æ‰§è¡Œ Workflow ä»£ç 
3. é‡åˆ° Activity è°ƒç”¨æ—¶ï¼Œæ£€æŸ¥äº‹ä»¶å†å²
4. å¦‚æœå†å²ä¸­æœ‰ç»“æœï¼Œç›´æ¥ä½¿ç”¨ï¼ˆä¸é‡æ–°æ‰§è¡Œï¼‰
5. å¦‚æœæ²¡æœ‰ç»“æœï¼Œå®é™…æ‰§è¡Œå¹¶è®°å½•

**éªŒè¯**:
- Temporal SDK ä¼šå¯¹æ¯”é‡æ”¾äº§ç”Ÿçš„å‘½ä»¤åºåˆ—ä¸å†å²è®°å½•
- å¦‚æœä¸ä¸€è‡´ï¼ŒæŠ›å‡º `NonDeterministicException`

#### æˆ‘ä»¬çš„å®ç°

**å·¥ä½œæµä»£ç è¦æ±‚**:
```kotlin
// æˆ‘ä»¬çš„ Workflow (Kotlin)
class CodeReviewWorkflow(
    private val executor: DurableAgentExecutor
) {
    suspend fun execute() {
        // Activity è°ƒç”¨ï¼ˆè‡ªåŠ¨åŒ…è£…ï¼‰
        val llmResult = executor.callActivity("LLMCall") {
            llmService.chat("Review this code...")
        }
        
        // âœ… å…è®¸ï¼šç¡®å®šæ€§é€»è¾‘
        val summary = llmResult.substring(0, 100)
        
        // Activity è°ƒç”¨ï¼ˆå·¥å…·æ‰§è¡Œï¼‰
        executor.callActivity("Tool:read_file") {
            toolRegistry.execute("read_file", mapOf("path" to "README.md"))
        }
        
        // ç­‰å¾…ä¿¡å·ï¼ˆè‡ªåŠ¨ä¿å­˜æ£€æŸ¥ç‚¹ï¼‰
        val approval = executor.waitForSignal("approval", timeoutMs = 3600000)
        
        if (approval.data["approved"] == true) {
            // ...
        }
    }
}
```

**é‡æ”¾æœºåˆ¶**:
```kotlin
suspend fun callActivity(name: String, block: suspend () -> Any): Any {
    // 1. æ£€æŸ¥æ˜¯å¦åœ¨é‡æ”¾æ¨¡å¼
    if (isReplaying()) {
        // ä»å†å²äº‹ä»¶ä¸­è¯»å–ç»“æœ
        val historicalEvent = getHistoricalEvent(name)
        return Json.decodeFromString(historicalEvent.eventData)
    }
    
    // 2. å®é™…æ‰§è¡Œ
    val result = block()
    
    // 3. è®°å½•äº‹ä»¶
    recordEvent(name, result)
    
    return result
}

private fun isReplaying(): Boolean {
    // å½“å‰æ­¥éª¤ç´¢å¼• < å†å²äº‹ä»¶æ•°é‡
    return currentStepIndex < historicalEvents.size
}
```

**å¯¹æ¯”**:

| ç»´åº¦ | Temporal | æˆ‘ä»¬çš„æ–¹æ¡ˆ |
|-----|---------|-----------|
| **çº¦æŸå¼ºåº¦** | ä¸¥æ ¼ï¼ˆç¼–è¯‘æ—¶æ£€æŸ¥ï¼‰ | å®½æ¾ï¼ˆè¿è¡Œæ—¶æ£€æŸ¥ï¼‰ |
| **é‡æ”¾ç²’åº¦** | æ¯ä¸ªå†³ç­–ç‚¹ | æ¯ä¸ª Activity |
| **éç¡®å®šæ€§æ£€æµ‹** | SDK è‡ªåŠ¨æ£€æµ‹ | æ‰‹åŠ¨æ£€æŸ¥ |
| **æ˜“ç”¨æ€§** | å­¦ä¹ æ›²çº¿é™¡å³­ | ç›¸å¯¹ç®€å• |

**æƒè¡¡**: æˆ‘ä»¬çš„æ–¹æ¡ˆæ›´æ˜“ç”¨ï¼Œä½†éœ€è¦å¼€å‘è€…æ‰‹åŠ¨ç¡®ä¿ç¡®å®šæ€§ï¼ˆé€šè¿‡ Activity åŒ…è£…ï¼‰ã€‚

### 2.3 é•¿æ—¶é—´è¿è¡Œ (Long-running Workflows)

#### Temporal çš„å®ç°

**ä¼‘çœ æœºåˆ¶**:
```java
// Temporal: ä¼‘çœ  7 å¤©
Workflow.sleep(Duration.ofDays(7));

// åº•å±‚å®ç°ï¼š
// 1. åˆ›å»º Timer äº‹ä»¶
// 2. Worker é€€å‡ºï¼ˆä¸å ç”¨èµ„æºï¼‰
// 3. Temporal Server åœ¨ 7 å¤©åç”Ÿæˆ TimerFired äº‹ä»¶
// 4. å°†ä»»åŠ¡é‡æ–°æ”¾å…¥é˜Ÿåˆ—
// 5. æ–° Worker æ‹¾å–ä»»åŠ¡ï¼Œç»§ç»­æ‰§è¡Œ
```

**èµ„æºæ¶ˆè€—**:
- âŒ å†…å­˜ï¼š0ï¼ˆWorker å·²é€€å‡ºï¼‰
- âœ… å­˜å‚¨ï¼šä»…äº‹ä»¶å†å²ï¼ˆæ•° KBï¼‰
- âœ… æ•°æ®åº“ï¼šä¸€æ¡å®šæ—¶å™¨è®°å½•

#### æˆ‘ä»¬çš„å®ç°

**ä¼‘çœ æœºåˆ¶**:
```kotlin
// æˆ‘ä»¬çš„æ–¹æ¡ˆï¼šç­‰å¾…ä¿¡å·ï¼ˆå¸¦è¶…æ—¶ï¼‰
val approval = waitForSignal(
    signalName = "CodeReviewApproval",
    timeoutMs = 7 * 24 * 3600 * 1000L  // 7 å¤©
)

// åº•å±‚å®ç°ï¼š
suspend fun waitForSignal(signalName: String, timeoutMs: Long): WorkflowSignal {
    // 1. è®°å½• WaitingForSignal äº‹ä»¶
    recordEvent("WaitingForSignal", mapOf("signalName" to signalName))
    
    // 2. åˆ›å»ºæ£€æŸ¥ç‚¹ï¼ˆä¿å­˜å½“å‰çŠ¶æ€ï¼‰
    createCheckpoint()
    
    // 3. é˜»å¡ç­‰å¾…ï¼ˆåç¨‹æŒ‚èµ·ï¼Œä¸å ç”¨çº¿ç¨‹ï¼‰
    return withTimeout(timeoutMs) {
        signalQueue.await(workflowId, signalName)
    }
    
    // æ³¨æ„ï¼šå¦‚æœæœåŠ¡å™¨é‡å¯ï¼Œä¼šä»æ£€æŸ¥ç‚¹æ¢å¤å¹¶é‡æ–°ç­‰å¾…
}
```

**SignalQueue å®ç°**:
```kotlin
class HybridSignalQueue {
    // å†…å­˜ Channelï¼ˆç”¨äºå¿«é€Ÿé€šçŸ¥ï¼‰
    private val channels = ConcurrentHashMap<String, Channel<WorkflowSignal>>()
    
    // æ•°æ®åº“ï¼ˆç”¨äºæŒä¹…åŒ–ï¼‰
    private val db: Database
    
    suspend fun await(workflowId: String, signalName: String): WorkflowSignal {
        // 1. æ£€æŸ¥æ•°æ®åº“ä¸­æ˜¯å¦å·²æœ‰ä¿¡å·ï¼ˆå¤„ç†æœåŠ¡å™¨é‡å¯ï¼‰
        val existingSignal = db.getUnprocessedSignal(workflowId, signalName)
        if (existingSignal != null) {
            return existingSignal
        }
        
        // 2. åˆ›å»º Channel å¹¶ç­‰å¾…
        val channel = channels.getOrPut(workflowId) { Channel(Channel.BUFFERED) }
        return channel.receive()  // åç¨‹æŒ‚èµ·ï¼Œç­‰å¾…ä¿¡å·
    }
    
    suspend fun enqueue(workflowId: String, signal: WorkflowSignal) {
        // 1. æŒä¹…åŒ–åˆ°æ•°æ®åº“
        db.insertSignal(signal)
        
        // 2. é€šçŸ¥å†…å­˜ Channelï¼ˆå¦‚æœå­˜åœ¨ç›‘å¬è€…ï¼‰
        channels[workflowId]?.send(signal)
    }
}
```

**èµ„æºæ¶ˆè€—**:
- âœ… å†…å­˜ï¼šåç¨‹æŒ‚èµ·ï¼ˆå‡ ä¹ä¸º 0ï¼‰
- âœ… å­˜å‚¨ï¼šæ£€æŸ¥ç‚¹ + äº‹ä»¶å†å²ï¼ˆæ•°å KBï¼‰
- âœ… æ•°æ®åº“ï¼šä¸€æ¡ signal è®°å½•

**å¯¹æ¯”**:

| ç»´åº¦ | Temporal | æˆ‘ä»¬çš„æ–¹æ¡ˆ |
|-----|---------|-----------|
| **å®ç°å¤æ‚åº¦** | é«˜ï¼ˆéœ€è¦ Timer Serviceï¼‰ | ä¸­ï¼ˆåç¨‹ + æ•°æ®åº“ï¼‰ |
| **æ”¯æŒçš„ä¼‘çœ æ—¶é•¿** | å‡ ä¹æ— é™ï¼ˆå¹´çº§åˆ«ï¼‰ | å—é™äºåç¨‹è¶…æ—¶ï¼ˆå»ºè®®æœˆçº§åˆ«ï¼‰ |
| **æœåŠ¡å™¨é‡å¯æ¢å¤** | è‡ªåŠ¨ï¼ˆä»é˜Ÿåˆ—æ¢å¤ï¼‰ | éœ€è¦æ‰«ææ•°æ®åº“é‡å¯å·¥ä½œæµ |

### 2.4 Signal/Query/Update åŸè¯­

#### Temporal çš„å®ç°

**Signal**:
```java
// Workflow å®šä¹‰
@SignalMethod
void approveCodeReview(boolean approved);

// å®¢æˆ·ç«¯å‘é€
workflowStub.approveCodeReview(true);

// Workflow å¤„ç†ï¼ˆå¼‚æ­¥ï¼‰
boolean approved = false;
Workflow.await(() -> approved);  // é˜»å¡ç›´åˆ° Signal åˆ°è¾¾
```

**Query**:
```java
// Workflow å®šä¹‰ï¼ˆåªè¯»ï¼ŒåŒæ­¥ï¼‰
@QueryMethod
String getStatus();

// å®¢æˆ·ç«¯æŸ¥è¯¢
String status = workflowStub.getStatus();  // ç«‹å³è¿”å›
```

**Update**:
```java
// Workflow å®šä¹‰ï¼ˆè¯»å†™ï¼ŒåŒæ­¥ï¼‰
@UpdateMethod
String updateAndGetResult(String input);

// å®¢æˆ·ç«¯è°ƒç”¨
String result = workflowStub.updateAndGetResult("data");  // ç­‰å¾…æ‰§è¡Œå¹¶è¿”å›
```

#### æˆ‘ä»¬çš„å®ç°

**Signal**:
```kotlin
// API
POST /api/workflows/{id}/signal
{
  "signalName": "CodeReviewApproval",
  "data": {"approved": true}
}

// å·¥ä½œæµå¤„ç†
val approval = waitForSignal("CodeReviewApproval", timeoutMs = 3600000)
if (approval.data["approved"] == true) { ... }
```

**Query**:
```kotlin
// API
GET /api/workflows/{id}/query

// å®ç°
fun queryState(workflowId: String): WorkflowState {
    // æ–¹æ¡ˆ 1: ä»æœ€æ–°æ£€æŸ¥ç‚¹è¯»å–
    val checkpoint = checkpointManager.getLatest(workflowId)
    return Json.decodeFromString(checkpoint.state)
    
    // æ–¹æ¡ˆ 2: ä»å†…å­˜ä¸­è¯»å–ï¼ˆå¦‚æœå·¥ä½œæµæ­£åœ¨è¿è¡Œï¼‰
    val executor = activeExecutors[workflowId]
    return executor?.currentState ?: recoverState(workflowId)
}
```

**Update**:
```kotlin
// API
POST /api/workflows/{id}/update
{
  "updateName": "ChangeIteration",
  "data": {"newIteration": 10}
}

// å®ç°
suspend fun executeUpdate(workflowId: String, update: WorkflowUpdate): Any {
    // 1. å‘é€ä¿¡å·
    val signal = WorkflowSignal(
        name = "update:${update.updateName}",
        data = update.data
    )
    signalQueue.enqueue(workflowId, signal)
    
    // 2. ç­‰å¾…ç»“æœï¼ˆé€šè¿‡å¦ä¸€ä¸ª Channelï¼‰
    val resultChannel = updateResultChannels.getOrPut(workflowId) { Channel() }
    return resultChannel.receive()
}

// å·¥ä½œæµå¤„ç†
val updateSignal = waitForSignal("update:ChangeIteration")
val newIteration = updateSignal.data["newIteration"] as Int
currentState = currentState.copy(currentIteration = newIteration)

// è¿”å›ç»“æœ
sendUpdateResult(updateSignal.id, "OK")
```

**å¯¹æ¯”**:

| ç‰¹æ€§ | Temporal | æˆ‘ä»¬çš„æ–¹æ¡ˆ | å¤‡æ³¨ |
|-----|---------|-----------|-----|
| **Signalï¼ˆå¼‚æ­¥ï¼‰** | âœ… åŸç”Ÿæ”¯æŒ | âœ… å®Œæ•´å®ç° | åŸºäº Channel + DB |
| **Queryï¼ˆåŒæ­¥è¯»ï¼‰** | âœ… å¼ºä¸€è‡´æ€§ | âš ï¸ æœ€ç»ˆä¸€è‡´æ€§ | ä»æ£€æŸ¥ç‚¹è¯»å–å¯èƒ½æœ‰å»¶è¿Ÿ |
| **Updateï¼ˆåŒæ­¥å†™ï¼‰** | âœ… åŸç”Ÿæ”¯æŒ | âš ï¸ éœ€è¦é¢å¤–å®ç° | é€šè¿‡ Signal + å“åº” Channel |

---

## ä¸‰ã€æ€§èƒ½ä¸æ‰©å±•æ€§å¯¹æ¯”

### 3.1 ååé‡

| åœºæ™¯ | Temporalï¼ˆåˆ†å¸ƒå¼ï¼‰ | æˆ‘ä»¬çš„æ–¹æ¡ˆï¼ˆå•æœºï¼‰ |
|-----|------------------|-------------------|
| **æ–°å»ºå·¥ä½œæµ** | ~1000 TPS | ~100 TPS |
| **äº‹ä»¶å†™å…¥** | ~10,000 TPS | ~500 TPS (SQLite) / ~2,000 TPS (PostgreSQL) |
| **Signal å¤„ç†** | ~5,000 TPS | ~200 TPS |

**åˆ†æ**:
- Temporal é€šè¿‡åˆ†ç‰‡å’Œåˆ†å¸ƒå¼æ¶æ„å®ç°é«˜åå
- æˆ‘ä»¬çš„æ–¹æ¡ˆå—é™äºå•æœºæ•°æ®åº“å†™å…¥æ€§èƒ½
- **é€‚ç”¨åœºæ™¯**: æˆ‘ä»¬çš„æ–¹æ¡ˆé€‚åˆä¸­å°è§„æ¨¡éƒ¨ç½²ï¼ˆ< 1000 å¹¶å‘å·¥ä½œæµï¼‰

### 3.2 å»¶è¿Ÿ

| æ“ä½œ | Temporal | æˆ‘ä»¬çš„æ–¹æ¡ˆ |
|-----|---------|-----------|
| **å¯åŠ¨å·¥ä½œæµ** | ~50-100ms (gRPC) | ~20-50ms (HTTP) |
| **Signal ä¼ é€’** | ~100-200ms | ~10-30ms (å†…å­˜ Channel) |
| **Query å“åº”** | ~50-100ms | ~5-20ms (ä»å†…å­˜/æ£€æŸ¥ç‚¹) |

**åˆ†æ**:
- æˆ‘ä»¬çš„æ–¹æ¡ˆåœ¨å•æœºéƒ¨ç½²ä¸‹å»¶è¿Ÿæ›´ä½ï¼ˆæ— ç½‘ç»œå¼€é”€ï¼‰
- Temporal åœ¨åˆ†å¸ƒå¼éƒ¨ç½²ä¸‹æœ‰é¢å¤–çš„ç½‘ç»œè·³è½¬

### 3.3 å­˜å‚¨å¼€é”€

| ç»´åº¦ | Temporal | æˆ‘ä»¬çš„æ–¹æ¡ˆ |
|-----|---------|-----------|
| **å•ä¸ªå·¥ä½œæµäº‹ä»¶æ•°** | 1,000 - 10,000 | 10 - 100 |
| **å•ä¸ªå·¥ä½œæµå­˜å‚¨** | ~1-10 MB | ~10-100 KB |
| **æ£€æŸ¥ç‚¹é¢‘ç‡** | æ— ï¼ˆé‡æ”¾ä»£æ›¿ï¼‰ | æ¯ 10 æ­¥æˆ– LLM è°ƒç”¨å |

**åˆ†æ**:
- æˆ‘ä»¬çš„æ–¹æ¡ˆé€šè¿‡ç²—ç²’åº¦äº‹ä»¶å’Œæ£€æŸ¥ç‚¹å‡å°‘å­˜å‚¨
- ä»£ä»·æ˜¯å®¡è®¡ç²’åº¦é™ä½

---

## å››ã€åŠŸèƒ½ç‰¹æ€§å¯¹æ¯”

### 4.1 å®Œæ•´ç‰¹æ€§å¯¹æ¯”è¡¨

| ç‰¹æ€§ | Temporal | æˆ‘ä»¬çš„æ–¹æ¡ˆ | å®æ–½éš¾åº¦ | ä¼˜å…ˆçº§ |
|-----|---------|-----------|---------|-------|
| **æŒä¹…åŒ–æ‰§è¡Œ** | âœ… | âœ… | ä¸­ | P0 |
| **äº‹ä»¶æº¯æº** | âœ… | âœ… (ç²—ç²’åº¦) | ä½ | P0 |
| **ç¡®å®šæ€§é‡æ”¾** | âœ… | âš ï¸ (éœ€æ‰‹åŠ¨ä¿è¯) | ä¸­ | P1 |
| **Signal** | âœ… | âœ… | ä½ | P0 |
| **Query** | âœ… | âœ… (æœ€ç»ˆä¸€è‡´æ€§) | ä½ | P1 |
| **Update** | âœ… | âš ï¸ | ä¸­ | P2 |
| **å­å·¥ä½œæµ** | âœ… | âš ï¸ | ä¸­ | P2 |
| **Cron å®šæ—¶ä»»åŠ¡** | âœ… | âŒ | ä¸­ | P3 |
| **æœç´¢ API** | âœ… | âŒ | é«˜ | P3 |
| **ç‰ˆæœ¬æ§åˆ¶** | âœ… (Worker Versioning) | âŒ | é«˜ | P3 |
| **å¤šç§Ÿæˆ·** | âœ… (Namespace) | âš ï¸ (é€šè¿‡ userId) | ä½ | P2 |
| **é‡è¯•ç­–ç•¥** | âœ… (ä¸°å¯Œé…ç½®) | âš ï¸ (ç®€å•é‡è¯•) | ä¸­ | P2 |
| **è¶…æ—¶æ§åˆ¶** | âœ… (å¤šç§è¶…æ—¶) | âš ï¸ (ç®€å•è¶…æ—¶) | ä½ | P2 |
| **æ´»åŠ¨å¿ƒè·³** | âœ… | âŒ | ä¸­ | P3 |
| **ä¾§æ•ˆåº” API** | âœ… (SideEffect) | âŒ | ä½ | P3 |

### 4.2 AI Agent ç‰¹å®šç‰¹æ€§å¯¹æ¯”

| ç‰¹æ€§ | Temporal | æˆ‘ä»¬çš„æ–¹æ¡ˆ | è¯´æ˜ |
|-----|---------|-----------|-----|
| **LLM æµå¼è¾“å‡º** | âŒ (éœ€ä¾§ä¿¡é“) | âœ… (SSE) | æˆ‘ä»¬å·²æœ‰ SSE åŸºç¡€è®¾æ–½ |
| **å¯¹è¯å†å²ç®¡ç†** | âš ï¸ (éœ€æ‰‹åŠ¨) | âœ… (å†…ç½®) | ChatHistoryManager å·²å­˜åœ¨ |
| **å·¥å…·è°ƒç”¨è®°å½•** | âœ… | âœ… | Timeline äº‹ä»¶ |
| **é”™è¯¯æ¢å¤ Agent** | âš ï¸ (éœ€æ‰‹åŠ¨) | âœ… (å·²æœ‰) | ErrorRecoveryAgent |
| **å¤š Agent ååŒ** | âœ… (å­å·¥ä½œæµ) | âš ï¸ (éœ€å®ç°) | SubAgentManager åŸºç¡€å­˜åœ¨ |

---

## äº”ã€æˆæœ¬å¯¹æ¯”

### 5.1 å¼€å‘æˆæœ¬

| é˜¶æ®µ | Temporal | æˆ‘ä»¬çš„æ–¹æ¡ˆ |
|-----|---------|-----------|
| **å­¦ä¹ æˆæœ¬** | ğŸ”´ é«˜ï¼ˆæ–°æ¦‚å¿µå¤šï¼‰ | ğŸŸ¢ ä½ï¼ˆåŸºäºç°æœ‰çŸ¥è¯†ï¼‰ |
| **åˆå§‹å¼€å‘** | ğŸŸ¢ ä½ï¼ˆSDK é½å…¨ï¼‰ | ğŸŸ¡ ä¸­ï¼ˆéœ€å®ç°åŸºç¡€è®¾æ–½ï¼‰ |
| **é›†æˆæˆæœ¬** | ğŸŸ¡ ä¸­ï¼ˆéœ€é€‚é…ï¼‰ | ğŸŸ¢ ä½ï¼ˆå¤ç”¨ç°æœ‰ä»£ç ï¼‰ |
| **æµ‹è¯•æˆæœ¬** | ğŸŸ¡ ä¸­ï¼ˆéœ€å­¦ä¹ æµ‹è¯•æ¡†æ¶ï¼‰ | ğŸŸ¢ ä½ï¼ˆæ ‡å‡†å•å…ƒæµ‹è¯•ï¼‰ |

### 5.2 è¿ç»´æˆæœ¬

| ç»´åº¦ | Temporal | æˆ‘ä»¬çš„æ–¹æ¡ˆ |
|-----|---------|-----------|
| **éƒ¨ç½²å¤æ‚åº¦** | ğŸ”´ é«˜ï¼ˆ4 ä¸ªæœåŠ¡ + DBï¼‰ | ğŸŸ¢ ä½ï¼ˆå•è¿›ç¨‹ + DBï¼‰ |
| **ç›‘æ§å¤æ‚åº¦** | ğŸŸ¡ ä¸­ï¼ˆå¤šæœåŠ¡æŒ‡æ ‡ï¼‰ | ğŸŸ¢ ä½ï¼ˆå•è¿›ç¨‹æŒ‡æ ‡ï¼‰ |
| **æ•…éšœæ’æŸ¥** | ğŸ”´ é«˜ï¼ˆåˆ†å¸ƒå¼è¿½è¸ªï¼‰ | ğŸŸ¢ ä½ï¼ˆå•è¿›ç¨‹æ—¥å¿—ï¼‰ |
| **å‡çº§æˆæœ¬** | ğŸŸ¡ ä¸­ï¼ˆå¤šæœåŠ¡åè°ƒï¼‰ | ğŸŸ¢ ä½ï¼ˆå•è¿›ç¨‹é‡å¯ï¼‰ |

### 5.3 åŸºç¡€è®¾æ–½æˆæœ¬

| èµ„æº | Temporalï¼ˆè‡ªæ‰˜ç®¡ï¼‰ | Temporal Cloud | æˆ‘ä»¬çš„æ–¹æ¡ˆ |
|-----|-------------------|---------------|-----------|
| **æœåŠ¡å™¨** | ~$500/æœˆï¼ˆ4 æ ¸å¿ƒæœåŠ¡ï¼‰ | ~$1000/æœˆ | ~$100/æœˆï¼ˆå•æœåŠ¡å™¨ï¼‰ |
| **æ•°æ®åº“** | ~$200/æœˆ (Cassandra/PG) | åŒ…å«åœ¨å†… | ~$50/æœˆ (PostgreSQL) |
| **å­˜å‚¨** | ~$100/æœˆ (å¤§é‡äº‹ä»¶) | æŒ‰ Action è®¡è´¹ | ~$20/æœˆ (å°‘é‡äº‹ä»¶) |
| **æ€»è®¡** | ~$800/æœˆ | ~$1000+/æœˆ | ~$170/æœˆ |

**æ³¨æ„**: Temporal Cloud æŒ‰ Actionï¼ˆçŠ¶æ€è½¬æ¢æ¬¡æ•°ï¼‰è®¡è´¹ï¼Œå¤§è§„æ¨¡ä½¿ç”¨æˆæœ¬å¯èƒ½æ›´é«˜ã€‚

---

## å…­ã€é€‚ç”¨åœºæ™¯åˆ†æ

### 6.1 Temporal æ›´é€‚åˆçš„åœºæ™¯

âœ… **æ¨èä½¿ç”¨ Temporal**:
1. é«˜å¹¶å‘ï¼ˆ> 1000 å¹¶å‘å·¥ä½œæµï¼‰
2. éœ€è¦åˆ†å¸ƒå¼éƒ¨ç½²ï¼ˆå¤šæ•°æ®ä¸­å¿ƒï¼‰
3. å›¢é˜Ÿå·²æœ‰ Temporal ç»éªŒ
4. éœ€è¦å¤æ‚çš„é‡è¯•ç­–ç•¥å’Œè¶…æ—¶æ§åˆ¶
5. å·¥ä½œæµé€»è¾‘å¤æ‚ï¼ˆæ•°ç™¾æ­¥ï¼‰
6. éœ€è¦å¤šè¯­è¨€æ”¯æŒï¼ˆJava/Go/Python/TypeScriptï¼‰

### 6.2 æˆ‘ä»¬çš„æ–¹æ¡ˆæ›´é€‚åˆçš„åœºæ™¯

âœ… **æ¨èä½¿ç”¨æˆ‘ä»¬çš„æ–¹æ¡ˆ**:
1. ä¸­å°è§„æ¨¡éƒ¨ç½²ï¼ˆ< 1000 å¹¶å‘å·¥ä½œæµï¼‰
2. å•æœºæˆ–å°é›†ç¾¤éƒ¨ç½²
3. å¿«é€Ÿè¿­ä»£ï¼ˆ2-3 å‘¨å®Œæˆ MVPï¼‰
4. å›¢é˜Ÿç†Ÿæ‚‰ Kotlin/Coroutines
5. å·¥ä½œæµé€»è¾‘ç®€å•ï¼ˆæ•°åæ­¥ï¼‰
6. ä¸ç°æœ‰ mpp-core/mpp-server æ·±åº¦é›†æˆ
7. **AI Agent åœºæ™¯**ï¼ˆLLM æµå¼è¾“å‡ºã€å¯¹è¯ç®¡ç†ï¼‰

### 6.3 ç‰¹å®šåœºæ™¯å†³ç­–

| åœºæ™¯ | æ¨èæ–¹æ¡ˆ | ç†ç”± |
|-----|---------|-----|
| **ä»£ç å®¡æŸ¥ Agentï¼ˆç­‰å¾…äººç±»å®¡æ‰¹ï¼‰** | æˆ‘ä»¬çš„æ–¹æ¡ˆ | ç®€å•çš„ Signal æœºåˆ¶ï¼Œæ— éœ€åˆ†å¸ƒå¼ |
| **å¤š Agent åä½œå¼€å‘** | æˆ‘ä»¬çš„æ–¹æ¡ˆ | SubAgentManager å·²å­˜åœ¨ |
| **å¤§è§„æ¨¡ SaaSï¼ˆæ•°ä¸‡ç”¨æˆ·ï¼‰** | Temporal | éœ€è¦åˆ†å¸ƒå¼éƒ¨ç½² |
| **é‡‘èäº¤æ˜“å·¥ä½œæµ** | Temporal | éœ€è¦ä¸¥æ ¼çš„ ACID ä¿è¯ |
| **å†…éƒ¨å·¥å…·ï¼ˆæ•°åç”¨æˆ·ï¼‰** | æˆ‘ä»¬çš„æ–¹æ¡ˆ | ç®€åŒ–éƒ¨ç½²å’Œç»´æŠ¤ |

---

## ä¸ƒã€è¿ç§»è·¯å¾„

### 7.1 ä»æˆ‘ä»¬çš„æ–¹æ¡ˆè¿ç§»åˆ° Temporal

**è§¦å‘æ¡ä»¶**:
- å¹¶å‘å·¥ä½œæµæ•° > 1000
- å•æœºæ€§èƒ½æˆä¸ºç“¶é¢ˆ
- éœ€è¦å¤šæ•°æ®ä¸­å¿ƒéƒ¨ç½²

**è¿ç§»æ­¥éª¤**:
1. ä¿æŒ API æ¥å£ä¸å˜ï¼ˆWorkflowControllerï¼‰
2. å®ç° Temporal Workflowï¼ˆæ˜ å°„ç°æœ‰ DurableAgentExecutorï¼‰
3. å®ç° Temporal Activitiesï¼ˆæ˜ å°„ç°æœ‰ ToolRegistryï¼‰
4. æ•°æ®è¿ç§»ï¼ˆäº‹ä»¶å†å² â†’ Temporal äº‹ä»¶ï¼‰
5. é€æ­¥åˆ‡æµï¼ˆæ–°å·¥ä½œæµèµ° Temporalï¼Œæ—§å·¥ä½œæµç»§ç»­è¿è¡Œï¼‰

**è¿ç§»æˆæœ¬**: ğŸŸ¡ ä¸­ï¼ˆçº¦ 1-2 ä¸ªæœˆï¼‰

### 7.2 æ··åˆæ¨¡å¼

**å¯è¡Œæ–¹æ¡ˆ**:
- ç®€å•å·¥ä½œæµï¼šä½¿ç”¨æˆ‘ä»¬çš„æ–¹æ¡ˆ
- å¤æ‚å·¥ä½œæµï¼šä½¿ç”¨ Temporal
- é€šè¿‡ç»Ÿä¸€çš„ API ç½‘å…³è·¯ç”±

---

## å…«ã€æ€»ç»“ä¸å»ºè®®

### 8.1 æ ¸å¿ƒç»“è®º

| ç»´åº¦ | Temporal | æˆ‘ä»¬çš„æ–¹æ¡ˆ |
|-----|---------|-----------|
| **åŠŸèƒ½å®Œæ•´æ€§** | â­â­â­â­â­ | â­â­â­â­ |
| **æ˜“ç”¨æ€§** | â­â­â­ | â­â­â­â­â­ |
| **æ€§èƒ½ï¼ˆå•æœºï¼‰** | â­â­â­ | â­â­â­â­â­ |
| **æ€§èƒ½ï¼ˆåˆ†å¸ƒå¼ï¼‰** | â­â­â­â­â­ | â­â­ |
| **æˆæœ¬** | â­â­ | â­â­â­â­â­ |
| **æ‰©å±•æ€§** | â­â­â­â­â­ | â­â­â­ |
| **ç¤¾åŒºæ”¯æŒ** | â­â­â­â­â­ | â­ |

### 8.2 æ¨èå†³ç­–

**âœ… æ¨èä½¿ç”¨æˆ‘ä»¬çš„æ–¹æ¡ˆï¼ˆTemporal Liteï¼‰**ï¼Œç†ç”±ï¼š
1. **å¿«é€Ÿè¿­ä»£**: 2-3 å‘¨å®Œæˆ MVPï¼Œç«‹å³å¯ç”¨
2. **ä½æˆæœ¬**: å¼€å‘æˆæœ¬ã€è¿ç»´æˆæœ¬ã€åŸºç¡€è®¾æ–½æˆæœ¬éƒ½æ˜¾è‘—é™ä½
3. **æ·±åº¦é›†æˆ**: ä¸ç°æœ‰ mpp-core/mpp-server æ— ç¼é›†æˆ
4. **é€‚é…åœºæ™¯**: ä¸­å°è§„æ¨¡ AI Agent åº”ç”¨çš„éœ€æ±‚å®Œå…¨æ»¡è¶³
5. **æ‰©å±•è·¯å¾„**: æœªæ¥å¯è¿ç§»åˆ° Temporalï¼ˆä¿æŒ API å…¼å®¹ï¼‰

**âš ï¸ åç»­è¯„ä¼°ç‚¹**:
- å½“å¹¶å‘å·¥ä½œæµæ•° > 500 æ—¶ï¼Œé‡æ–°è¯„ä¼°
- å½“éœ€è¦å¤šæ•°æ®ä¸­å¿ƒéƒ¨ç½²æ—¶ï¼Œè€ƒè™‘è¿ç§»

### 8.3 å®æ–½å»ºè®®

**Phase 1ï¼ˆMVPï¼‰**:
- ä»…å®ç°æ ¸å¿ƒç‰¹æ€§ï¼ˆäº‹ä»¶æº¯æºã€æ£€æŸ¥ç‚¹ã€Signalï¼‰
- ä½¿ç”¨ SQLiteï¼ˆç®€åŒ–éƒ¨ç½²ï¼‰
- å•æœºéƒ¨ç½²ï¼ˆKtor + SQLiteï¼‰

**Phase 2ï¼ˆä¼˜åŒ–ï¼‰**:
- å‡çº§åˆ° PostgreSQL
- æ·»åŠ  Query/Update åŸè¯­
- å®ç°å­å·¥ä½œæµ

**Phase 3ï¼ˆå¢å¼ºï¼‰**:
- æ·»åŠ ç›‘æ§é¢æ¿
- å®ç°ä¾§ä¿¡é“æµå¼ä¼ è¾“
- ç‰ˆæœ¬æ§åˆ¶

**Phase 4ï¼ˆæ‰©å±•ï¼Œå¯é€‰ï¼‰**:
- å¦‚æœè§„æ¨¡å¢é•¿ï¼Œè¯„ä¼°è¿ç§»åˆ° Temporal
- æˆ–è€…å®ç°ç®€å•çš„ Worker æ± ï¼ˆå¤šæœåŠ¡å™¨éƒ¨ç½²ï¼‰

---

**æœ€ç»ˆå»ºè®®**: å…ˆç”¨æˆ‘ä»¬çš„ "Temporal Lite" æ–¹æ¡ˆå¿«é€ŸéªŒè¯ä¸šåŠ¡ä»·å€¼ï¼Œé¿å…è¿‡åº¦å·¥ç¨‹åŒ–ã€‚å¦‚æœæœªæ¥ç¡®å®é‡åˆ°æ‰©å±•æ€§ç“¶é¢ˆï¼Œå†è€ƒè™‘è¿ç§»åˆ°å®Œæ•´çš„ Temporalã€‚

